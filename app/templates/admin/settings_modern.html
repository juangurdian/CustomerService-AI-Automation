{% extends "base_modern.html" %}

{% block title %}Configuración - {{ config.business.name }}{% endblock %}
{% block page_title %}Configuración{% endblock %}
{% block page_subtitle %}Ajustes generales del sistema, API keys y configuración del negocio{% endblock %}

{% block content %}
<div class="p-6 space-y-6">
    <!-- Quick Actions -->
    <div class="bg-white/80 backdrop-blur-lg rounded-2xl p-6 border border-gray-200/50 shadow-lg">
        <h3 class="text-lg font-semibold text-gray-900 mb-4">Acciones Rápidas</h3>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <button onclick="rebuildIndex()" class="flex flex-col items-center p-4 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors group">
                <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center mb-3 group-hover:scale-105 transition-transform">
                    <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                    </svg>
                </div>
                <p class="text-sm font-medium text-gray-900">Re-indexar</p>
                <p class="text-xs text-gray-500 text-center">Actualizar índice de búsqueda</p>
            </button>
            
            <button onclick="downloadBackup()" class="flex flex-col items-center p-4 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors group">
                <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center mb-3 group-hover:scale-105 transition-transform">
                    <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3-3m0 0l-3 3m3-3v12"></path>
                    </svg>
                </div>
                <p class="text-sm font-medium text-gray-900">Backup BD</p>
                <p class="text-xs text-gray-500 text-center">Descargar copia de seguridad</p>
            </button>
            
            <button onclick="exportConfig()" class="flex flex-col items-center p-4 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors group">
                <div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-violet-600 rounded-xl flex items-center justify-center mb-3 group-hover:scale-105 transition-transform">
                    <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                </div>
                <p class="text-sm font-medium text-gray-900">Exportar Config</p>
                <p class="text-xs text-gray-500 text-center">Guardar configuración</p>
            </button>
            
            <a href="/healthz" target="_blank" class="flex flex-col items-center p-4 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors group">
                <div class="w-12 h-12 bg-gradient-to-br from-orange-500 to-red-600 rounded-xl flex items-center justify-center mb-3 group-hover:scale-105 transition-transform">
                    <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                </div>
                <p class="text-sm font-medium text-gray-900">Health Check</p>
                <p class="text-xs text-gray-500 text-center">Verificar estado del sistema</p>
            </a>
        </div>
    </div>

    <!-- AI Configuration -->
    <div class="bg-white/80 backdrop-blur-lg rounded-2xl p-6 border border-gray-200/50 shadow-lg">
        <div class="flex items-center justify-between mb-6">
            <h2 class="text-xl font-bold text-gray-900 flex items-center">
                <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center mr-3">
                    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                    </svg>
                </div>
                Configuración de AI
            </h2>
        </div>
        
        <div class="grid md:grid-cols-2 gap-6">
            <div class="bg-blue-50 rounded-xl p-6">
                <h3 class="font-semibold text-gray-900 mb-4 flex items-center">
                    <svg class="w-5 h-5 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                    Modo Actual
                </h3>
                <div class="bg-white rounded-lg p-4 border border-blue-200">
                    <div class="flex items-center justify-between mb-2">
                        <p class="font-medium text-blue-800 text-lg">{{ config.ai.mode }}</p>
                        <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium">Activo</span>
                    </div>
                    <p class="text-sm text-blue-600">
                        {% if config.ai.mode == 'rag_only' %}
                        Solo base de conocimiento (gratuito)
                        {% elif config.ai.mode == 'api_llm' %}
                        Usando API externa ({{ config.ai.model_name }})
                        {% elif config.ai.mode == 'local_llm' %}
                        Modelo local ({{ config.ai.model_name }})
                        {% endif %}
                    </p>
                </div>
            </div>
            
            <div class="bg-green-50 rounded-xl p-6">
                <h3 class="font-semibold text-gray-900 mb-4 flex items-center">
                    <svg class="w-5 h-5 mr-2 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    APIs Configuradas
                </h3>
                <div class="space-y-3">
                    <div class="flex items-center justify-between bg-white rounded-lg p-3 border border-green-200">
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center mr-3">
                                <svg class="w-4 h-4 text-gray-600" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                                    <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                                    <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                                    <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                                </svg>
                            </div>
                            <span class="text-gray-800 font-medium">OpenAI</span>
                        </div>
                        <span class="text-sm {{ 'text-green-600 bg-green-100' if settings.openai_configured else 'text-gray-500 bg-gray-100' }} px-3 py-1 rounded-full font-medium">
                            {{ '✅ Configurado' if settings.openai_configured else '⚪ No configurado' }}
                        </span>
                    </div>
                    
                    <div class="flex items-center justify-between bg-white rounded-lg p-3 border border-green-200">
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                                <svg class="w-4 h-4 text-blue-600" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M12 0C5.37 0 0 5.37 0 12s5.37 12 12 12 12-5.37 12-12S18.63 0 12 0zm0 22C6.48 22 2 17.52 2 12S6.48 2 12 2s10 4.48 10 10-4.48 10-10 10z"/>
                                </svg>
                            </div>
                            <span class="text-gray-800 font-medium">Groq</span>
                        </div>
                        <span class="text-sm {{ 'text-green-600 bg-green-100' if settings.groq_configured else 'text-gray-500 bg-gray-100' }} px-3 py-1 rounded-full font-medium">
                            {{ '✅ Configurado' if settings.groq_configured else '⚪ No configurado' }}
                        </span>
                    </div>
                    
                    <div class="flex items-center justify-between bg-white rounded-lg p-3 border border-green-200">
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center mr-3">
                                <svg class="w-4 h-4 text-purple-600" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M12 0L1.608 6v12L12 24l10.392-6V6L12 0zm0 2.4L20.4 7.2v9.6L12 21.6 3.6 16.8V7.2L12 2.4z"/>
                                </svg>
                            </div>
                            <span class="text-gray-800 font-medium">Gemini</span>
                        </div>
                        <span class="text-sm {{ 'text-green-600 bg-green-100' if settings.gemini_configured else 'text-gray-500 bg-gray-100' }} px-3 py-1 rounded-full font-medium">
                            {{ '✅ Configurado' if settings.gemini_configured else '⚪ No configurado' }}
                        </span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="mt-6 bg-yellow-50 border border-yellow-200 rounded-xl p-4">
            <div class="flex items-center">
                <svg class="w-5 h-5 text-yellow-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <p class="text-yellow-800 text-sm">
                    <strong>Tip:</strong> Para cambiar las API keys, edita el archivo .env y reinicia la aplicación.
                </p>
            </div>
        </div>
    </div>

    <!-- Channel Status -->
    <div class="bg-white/80 backdrop-blur-lg rounded-2xl p-6 border border-gray-200/50 shadow-lg">
        <div class="flex items-center justify-between mb-6">
            <h2 class="text-xl font-bold text-gray-900 flex items-center">
                <div class="w-10 h-10 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center mr-3">
                    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                    </svg>
                </div>
                Estado de Canales
            </h2>
            <a href="/admin/channels" class="text-blue-600 hover:text-blue-700 font-medium flex items-center">
                <span>Configurar Canales</span>
                <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
            </a>
        </div>
        
        <div class="grid md:grid-cols-2 gap-6">
            <div class="bg-blue-50 rounded-xl p-6">
                <h3 class="font-semibold text-gray-900 mb-4 flex items-center">
                    <svg class="w-5 h-5 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                    </svg>
                    Canales de Comunicación
                </h3>
                <div class="space-y-3">
                    <div class="flex items-center justify-between bg-white rounded-lg p-3 border border-blue-200">
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-3">
                                <svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9v-9m0-9v9"></path>
                                </svg>
                            </div>
                            <span class="text-gray-800 font-medium">Web Chat</span>
                        </div>
                        <span class="text-sm text-green-600 bg-green-100 px-3 py-1 rounded-full font-medium">✅ Activo</span>
                    </div>
                    
                    <div class="flex items-center justify-between bg-white rounded-lg p-3 border border-blue-200">
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-3">
                                <svg class="w-4 h-4 text-green-600" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"/>
                                </svg>
                            </div>
                            <span class="text-gray-800 font-medium">WhatsApp</span>
                        </div>
                        <span class="text-sm {{ 'text-green-600 bg-green-100' if settings.twilio_configured or settings.whatsapp_configured else 'text-gray-500 bg-gray-100' }} px-3 py-1 rounded-full font-medium">
                            {{ '✅ Configurado' if settings.twilio_configured or settings.whatsapp_configured else '⚪ No configurado' }}
                        </span>
                    </div>
                    
                    <div class="flex items-center justify-between bg-white rounded-lg p-3 border border-blue-200">
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                                <svg class="w-4 h-4 text-blue-600" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
                                </svg>
                            </div>
                            <span class="text-gray-800 font-medium">Telegram</span>
                        </div>
                        <span class="text-sm {{ 'text-green-600 bg-green-100' if settings.telegram_configured else 'text-gray-500 bg-gray-100' }} px-3 py-1 rounded-full font-medium">
                            {{ '✅ Configurado' if settings.telegram_configured else '⚪ No configurado' }}
                        </span>
                    </div>
                </div>
            </div>
            
            <div class="bg-purple-50 rounded-xl p-6">
                <h3 class="font-semibold text-gray-900 mb-4 flex items-center">
                    <svg class="w-5 h-5 mr-2 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                    Próximos Pasos
                </h3>
                <div class="space-y-2 text-sm">
                    {% if not (settings.twilio_configured or settings.whatsapp_configured) %}
                    <a href="/admin/channels" class="flex items-center p-3 bg-white rounded-lg border border-purple-200 hover:bg-purple-50 transition-colors">
                        <svg class="w-4 h-4 mr-2 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                        </svg>
                        <span class="text-purple-800 font-medium">Configurar WhatsApp</span>
                    </a>
                    {% endif %}
                    
                    {% if not settings.telegram_configured %}
                    <a href="/admin/channels" class="flex items-center p-3 bg-white rounded-lg border border-purple-200 hover:bg-purple-50 transition-colors">
                        <svg class="w-4 h-4 mr-2 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                        </svg>
                        <span class="text-purple-800 font-medium">Configurar Telegram</span>
                    </a>
                    {% endif %}
                    
                    <a href="/admin/playground" class="flex items-center p-3 bg-white rounded-lg border border-purple-200 hover:bg-purple-50 transition-colors">
                        <svg class="w-4 h-4 mr-2 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                        </svg>
                        <span class="text-purple-800 font-medium">Probar el bot</span>
                    </a>
                    
                    <a href="/demo" target="_blank" class="flex items-center p-3 bg-white rounded-lg border border-purple-200 hover:bg-purple-50 transition-colors">
                        <svg class="w-4 h-4 mr-2 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                        </svg>
                        <span class="text-purple-800 font-medium">Ver demo público</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Business Configuration -->
    <div class="bg-white/80 backdrop-blur-lg rounded-2xl p-6 border border-gray-200/50 shadow-lg">
        <div class="flex items-center justify-between mb-6">
            <h2 class="text-xl font-bold text-gray-900 flex items-center">
                <div class="w-10 h-10 bg-gradient-to-br from-orange-500 to-red-600 rounded-xl flex items-center justify-center mr-3">
                    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
                    </svg>
                </div>
                Información del Negocio
            </h2>
            <a href="/admin/setup" class="text-blue-600 hover:text-blue-700 font-medium flex items-center">
                <span>Editar Información</span>
                <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                </svg>
            </a>
        </div>
        
        <div class="grid md:grid-cols-2 gap-6">
            <div class="bg-orange-50 rounded-xl p-6">
                <h3 class="font-semibold text-gray-900 mb-4 flex items-center">
                    <svg class="w-5 h-5 mr-2 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    Datos Básicos
                </h3>
                <div class="space-y-4">
                    <div class="bg-white rounded-lg p-4 border border-orange-200">
                        <label class="text-sm text-gray-600 font-medium">Nombre del Negocio</label>
                        <p class="font-bold text-gray-900 text-lg">{{ config.business.name }}</p>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4 border border-orange-200">
                        <label class="text-sm text-gray-600 font-medium">Dirección</label>
                        <p class="font-medium text-gray-900">{{ config.business.address or 'No configurada' }}</p>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4 border border-orange-200">
                        <label class="text-sm text-gray-600 font-medium">Teléfono</label>
                        <p class="font-medium text-gray-900">{{ config.business.phone or 'No configurado' }}</p>
                    </div>
                </div>
            </div>
            
            <div class="bg-teal-50 rounded-xl p-6">
                <h3 class="font-semibold text-gray-900 mb-4 flex items-center">
                    <svg class="w-5 h-5 mr-2 text-teal-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    Horarios de Atención
                </h3>
                {% if config.business.hours %}
                <div class="space-y-2">
                    {% for day, hours in config.business.hours.items() %}
                    <div class="flex justify-between items-center bg-white rounded-lg p-3 border border-teal-200">
                        <span class="text-gray-700 font-medium">{{ day.replace('_', ' ').title() }}</span>
                        <span class="font-bold text-gray-900">{{ hours }}</span>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div class="bg-white rounded-lg p-4 border border-teal-200 text-center">
                    <svg class="w-12 h-12 mx-auto text-gray-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <p class="text-gray-600 font-medium">No configurados</p>
                    <p class="text-sm text-gray-500">Agrega horarios en la configuración inicial</p>
                </div>
                {% endif %}
            </div>
        </div>
        
        <div class="mt-6 bg-blue-50 border border-blue-200 rounded-xl p-4">
            <div class="flex items-center">
                <svg class="w-5 h-5 text-blue-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <p class="text-blue-800 text-sm">
                    <strong>Para modificar:</strong> Utiliza la configuración inicial o edita el archivo config.yaml y reinicia la aplicación.
                </p>
            </div>
        </div>
    </div>

    <!-- Quick Setup Guide -->
    <div class="bg-white/80 backdrop-blur-lg rounded-2xl p-6 border border-gray-200/50 shadow-lg">
        <h2 class="text-xl font-bold text-gray-900 mb-6 flex items-center">
            <div class="w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl flex items-center justify-center mr-3">
                <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                </svg>
            </div>
            Guías Rápidas
        </h2>
        
        <div class="grid md:grid-cols-2 gap-6">
            <div class="bg-green-50 rounded-xl p-6">
                <h3 class="font-semibold text-gray-900 mb-4 flex items-center">
                    <svg class="w-5 h-5 mr-2 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    Para Comenzar
                </h3>
                <div class="space-y-3">
                    <a href="/admin/setup" class="flex items-center p-3 bg-white rounded-lg border border-green-200 hover:bg-green-50 transition-colors">
                        <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-mono mr-3 w-6 h-6 flex items-center justify-center">1</span>
                        <span class="text-green-800 font-medium">Completar configuración inicial</span>
                    </a>
                    
                    <a href="/admin/knowledge" class="flex items-center p-3 bg-white rounded-lg border border-green-200 hover:bg-green-50 transition-colors">
                        <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-mono mr-3 w-6 h-6 flex items-center justify-center">2</span>
                        <span class="text-green-800 font-medium">Cargar FAQs y documentos</span>
                    </a>
                    
                    <a href="/admin/menu" class="flex items-center p-3 bg-white rounded-lg border border-green-200 hover:bg-green-50 transition-colors">
                        <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-mono mr-3 w-6 h-6 flex items-center justify-center">3</span>
                        <span class="text-green-800 font-medium">Configurar menú de productos</span>
                    </a>
                    
                    <a href="/admin/playground" class="flex items-center p-3 bg-white rounded-lg border border-green-200 hover:bg-green-50 transition-colors">
                        <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-mono mr-3 w-6 h-6 flex items-center justify-center">4</span>
                        <span class="text-green-800 font-medium">Probar el bot en playground</span>
                    </a>
                    
                    <a href="/admin/channels" class="flex items-center p-3 bg-white rounded-lg border border-green-200 hover:bg-green-50 transition-colors">
                        <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-mono mr-3 w-6 h-6 flex items-center justify-center">5</span>
                        <span class="text-green-800 font-medium">Integrar widget en tu sitio</span>
                    </a>
                </div>
            </div>
            
            <div class="bg-blue-50 rounded-xl p-6">
                <h3 class="font-semibold text-gray-900 mb-4 flex items-center">
                    <svg class="w-5 h-5 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                    Para Producción
                </h3>
                <div class="space-y-3">
                    <div class="flex items-center p-3 bg-white rounded-lg border border-blue-200">
                        <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-mono mr-3 w-6 h-6 flex items-center justify-center">1</span>
                        <span class="text-blue-800 font-medium">Configurar dominio con HTTPS</span>
                    </div>
                    
                    <div class="flex items-center p-3 bg-white rounded-lg border border-blue-200">
                        <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-mono mr-3 w-6 h-6 flex items-center justify-center">2</span>
                        <span class="text-blue-800 font-medium">Actualizar webhooks de canales</span>
                    </div>
                    
                    <div class="flex items-center p-3 bg-white rounded-lg border border-blue-200">
                        <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-mono mr-3 w-6 h-6 flex items-center justify-center">3</span>
                        <span class="text-blue-800 font-medium">Configurar backups automáticos</span>
                    </div>
                    
                    <a href="/admin/analytics" class="flex items-center p-3 bg-white rounded-lg border border-blue-200 hover:bg-blue-50 transition-colors">
                        <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-mono mr-3 w-6 h-6 flex items-center justify-center">4</span>
                        <span class="text-blue-800 font-medium">Monitorear analítica</span>
                    </a>
                    
                    <a href="/admin/orders" class="flex items-center p-3 bg-white rounded-lg border border-blue-200 hover:bg-blue-50 transition-colors">
                        <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-mono mr-3 w-6 h-6 flex items-center justify-center">5</span>
                        <span class="text-blue-800 font-medium">Revisar pedidos regularmente</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
async function rebuildIndex() {
    if (confirm('¿Re-construir el índice de búsqueda? Esto puede tomar unos minutos.')) {
        const button = event.target.closest('button');
        const originalContent = button.innerHTML;
        
        // Show loading state
        button.innerHTML = `
            <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center mb-3 group-hover:scale-105 transition-transform">
                <svg class="w-6 h-6 text-white animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                </svg>
            </div>
            <p class="text-sm font-medium text-gray-900">Procesando...</p>
            <p class="text-xs text-gray-500 text-center">Por favor espere</p>
        `;
        button.disabled = true;
        
        try {
            const response = await fetch('/admin/rebuild-index', { method: 'POST' });
            if (response.ok) {
                // Show success state
                button.innerHTML = `
                    <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center mb-3 group-hover:scale-105 transition-transform">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </div>
                    <p class="text-sm font-medium text-gray-900">¡Completado!</p>
                    <p class="text-xs text-gray-500 text-center">Índice actualizado</p>
                `;
                
                setTimeout(() => {
                    location.reload();
                }, 2000);
            } else {
                throw new Error('Error en la respuesta del servidor');
            }
        } catch (error) {
            button.innerHTML = originalContent;
            button.disabled = false;
            alert('Error al reconstruir el índice: ' + error.message);
        }
    }
}

function downloadBackup() {
    if (confirm('¿Descargar backup de la base de datos?')) {
        const button = event.target.closest('button');
        const originalContent = button.innerHTML;
        
        // Show loading state
        button.innerHTML = `
            <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center mb-3 group-hover:scale-105 transition-transform">
                <svg class="w-6 h-6 text-white animate-bounce" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3-3m0 0l-3 3m3-3v12"></path>
                </svg>
            </div>
            <p class="text-sm font-medium text-gray-900">Descargando...</p>
            <p class="text-xs text-gray-500 text-center">Preparando archivo</p>
        `;
        
        window.location.href = '/api/backup/download';
        
        setTimeout(() => {
            button.innerHTML = originalContent;
        }, 3000);
    }
}

function exportConfig() {
    const button = event.target.closest('button');
    const originalContent = button.innerHTML;
    
    // Show loading state
    button.innerHTML = `
        <div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-violet-600 rounded-xl flex items-center justify-center mb-3 group-hover:scale-105 transition-transform">
            <svg class="w-6 h-6 text-white animate-pulse" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
            </svg>
        </div>
        <p class="text-sm font-medium text-gray-900">Exportando...</p>
        <p class="text-xs text-gray-500 text-center">Generando archivo</p>
    `;
    
    fetch('/api/config')
        .then(response => response.json())
        .then(config => {
            const blob = new Blob([JSON.stringify(config, null, 2)], { type: 'application/json' });
            const url = window.URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.style.display = 'none';
            a.href = url;
            a.download = `config_backup_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
            
            // Show success state
            button.innerHTML = `
                <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center mb-3 group-hover:scale-105 transition-transform">
                    <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                </div>
                <p class="text-sm font-medium text-gray-900">¡Exportado!</p>
                <p class="text-xs text-gray-500 text-center">Archivo descargado</p>
            `;
            
            setTimeout(() => {
                button.innerHTML = originalContent;
            }, 3000);
        })
        .catch(error => {
            button.innerHTML = originalContent;
            alert('Error exportando configuración: ' + error.message);
        });
}
</script>
{% endblock %}